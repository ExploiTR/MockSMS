package hacks.exploitr.mockSms.noplay;

import android.app.Application;
import android.os.Handler;
import android.widget.Toast;

import androidx.annotation.NonNull;
import androidx.annotation.Nullable;

import com.crashlytics.android.Crashlytics;
import com.github.javiersantos.piracychecker.PiracyChecker;
import com.github.javiersantos.piracychecker.enums.PiracyCheckerCallback;
import com.github.javiersantos.piracychecker.enums.PiracyCheckerError;
import com.github.javiersantos.piracychecker.enums.PirateApp;
import com.google.android.gms.ads.MobileAds;

import io.fabric.sdk.android.Fabric;
import androidx.annotation.Keep;

@Keep
public class MockApp extends Application {

    @Override
    public void onCreate() {
        MobileAds.initialize(this, "ca-app-pub-8111689089728808~5596943471");
        Fabric.with(this, new Crashlytics());
        new PiracyChecker(this)
                .enableEmulatorCheck(true)
                .enableUnauthorizedAppsCheck(true)
                .saveResultToSharedPreferences(getSharedPreferences("boo", MODE_PRIVATE), "valid_license")
                .callback(new PiracyCheckerCallback() {
                    @Override
                    public void allow() {
                    }

                    @Override
                    public void dontAllow(@NonNull PiracyCheckerError error, @Nullable PirateApp app) {
                        Toast.makeText(MockApp.this, error.toString(), Toast.LENGTH_SHORT).show();
                        new Handler().postDelayed(() -> System.exit(0), 10000);
                    }

                    @Override
                    public void onError(@NonNull PiracyCheckerError error) {
                        if (!(error == PiracyCheckerError.UNKNOWN | error == PiracyCheckerError.CHECK_IN_PROGRESS)) {
                            new Handler().postDelayed(() -> System.exit(0), 10000);
                        }
                        Crashlytics.logException(new RuntimeException(error.toString()));
                    }
                })
                .start();
        super.onCreate();
    }
}
